@if (query.loading()) {
  <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
} @else {
  <div class="material-grid">
    @if (query.materials().length > 0) {
      @for (material of query.materials(); track material.id) {
        <mat-card
          class="material-card"
          [ngStyle]="{ 'border-color': material.colorhex }"
          (click)="toggleSelection(material.id)"
          (keydown.enter)="toggleSelection(material.id)"
          tabindex="0"
        >
          <div
            class="material-header"
            [ngStyle]="{ 'background-color': material.colorhex }"
          >
            @if (
              store.selectSignal(
                MaterialSelectors.isMaterialSelected(material.id)
              )()
            ) {
              <mat-icon>check</mat-icon>
            }
          </div>

          <mat-card-header>
            <mat-card-title class="material-title">
              {{ material.name }}
            </mat-card-title>
          </mat-card-header>

          <mat-card-content>
            <p class="material-tolerance">
              Tolerance: Â± {{ material.shrinkage }} mm
            </p>
            <mat-progress-bar
              mode="determinate"
              [value]="getTolerancePercentage(material.shrinkage)"
            >
            </mat-progress-bar>
          </mat-card-content>

          <mat-card-actions>
            <button
              type="button"
              mat-button
              color="primary"
              (click)="showMoreInfo(material, $event)"
            >
              More information
            </button>
          </mat-card-actions>
        </mat-card>
      }
    } @else {
      <p>No materials available.</p>
    }
  </div>
}
